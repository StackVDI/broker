%h1 Welcome to StackVDI
%p Please, select the machine you want to connect to

-case current_user.machines.count
  -when 0
    %div.progress.progress-success.active
      %div.bar{:style => "width: 100%;"}
        You have 3 machines availables to launch
  -when 1
    %div.progress.progress.active
      %div.bar{:style => "width: 33%;"}
        You have 2 machines availables to launch
  -when 2
    %div.progress.progress-warning.active
      %div.bar{:style => "width: 66%;"}
        You have 1 machine available to launch
  -when 3
    %div.progress.progress-danger.active
      %div.bar{:style => "width: 100%;"}
        You don't have machines availables to launch



-if @running_machines

  %h2 Running Machines
  %table.table.table-bordered.table-hove
    %thead
      %th
      %th Name
      %th Description
      %th Address
      %th Date
      %th Actions

    %tbody
      - @running_machines.each do |machine|
        %tr
          %td
            %center= image_tag machine.image.avatar.url(:thumb)
          %td= machine.image.name
          %td= machine.image.description
          %td= machine.ip
          %td= machine.updated_at.localtime
          %td
            =link_to 'Connect', machine_path(machine) , :class => 'btn btn-mini btn-info', :id => "connect_machine_#{machine.id}", :method => :get
            =link_to 'Reboot', reboot_machine_path(machine) , :class => 'btn btn-mini btn-danger', :id => "reboot_machine_#{machine.id}", :method => :get, :data => { :confirm => 'Rebooting machine. Are you sure?' }
            =link_to 'Destroy', machine_path(machine) , :class => 'btn btn-mini btn-danger', :id => "destroy_machine_#{machine.id}", :method => :delete, :data => { :confirm => 'Are you sure?' }

%br

-if @available_images
  %h2 Available Images
  %table.table.table-bordered.table-hove
    %thead
      %th
      %th Name
      %th Description
      %th Actions

    %tbody
      - @available_images.each do |image|
        %tr
          %td 
            %center= image_tag image.avatar.url(:thumb)
          %td= image.name
          %td= image.description
          %td
            =link_to 'Launch', create_machine_path(image), :class => 'btn btn-mini btn-info', :id => "create_machine_#{image.id}", :method => :post

%br
